---
title: "Aderência dos Senadores em votações de plenário"
output: 
  html_document:
    css: styles.css
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  warning = FALSE,
  message = FALSE,
  fig.cap = '',
  fig.align = 'center',
  fig.width = 10,
  fig.height = 8
)
```

```{r results='hide'}
library(tidyverse)
library(DT)
library(ggplot2)
library(scales)
library(hrbrthemes)
library(here)
source(here("crawler/proposicoes/fetcher_proposicoes_senado.R"))
```

```{r results='hide'}
theme_set(theme_minimal())

votos <- read_csv(here("crawler/raw_data/votos.csv")) %>% 
  filter(casa == "senado")

numero_votacoes <- votos %>% 
  count(id_votacao) %>% 
  nrow()

senadores <- read_csv(here("crawler/raw_data/senadores.csv")) %>% 
  filter(em_exercicio == 1) %>% 
  mutate(nome_exibido = paste0(nome_eleitoral, " - ", sg_partido, "/", uf),
         id = as.character(id)) %>% 
  select(id, nome_exibido)

aderencia <- read_csv(here("reports/aderencia-senado/data/aderencia.csv")) %>% 
  mutate(id = str_remove(id_parlamentar_voz, "^(\\d){1}"), #remove o 1 do id_parlamentar_voz
         freq = (numero_votacoes - faltou)/numero_votacoes) %>% 
  filter(id_partido == 0)

aderencia <- aderencia %>% 
  left_join(senadores, by="id")

proposicoes <- fetch_proposicoes_plenario_selecionadas_senado()
```

### Resumo

Analisamos os senadores que mais seguem e o menos "obedientes" ao governo nas votações nominais de plenário do Senado Federal ocorridas em em 2019.

<br>

### O que é aderência

Aderência é uma faceta da atuação dos Deputados e Senadores Federais nas votações em plenário de cada casa. Um parlamentar é aderente ao Governo quando segue as orientações do Governo em votações nominais. Neste relatório, focamos nos senadores.

Para cada votação de cada senador, identificamos se ele seguiu a orientação do Governo ou não. Em seguida, calculamos o grau de aderência como a proporção das votações em que ele seguiu a orientação do Governo. Quando o Governo não apresentou orientação em uma votação, consideramos o voto do Líder do Governo como orientação.

### As proposições

A grande maioria das votações de plenário no Senado em 2019 são de escolhas de cargos, como embaixadores, ministros, etc., e são todas secretas, sem informação sobre os votos dos senadores. As demais votações nominais foram recuperadas, filtradas por tema e totalizam a cinco proposições: uma do tema **Direitos Humanos** e quatro sobre **Agenda Nacional**.

- A **PEC 25/2017** propõe *"incorporar a nomenclatura “pessoa com deficiência”, utilizada pela Convenção Internacional sobre o Direito das Pessoas com Deficiência"*;
- A **MPV 870/2019** estabelece *"a organização básica dos órgãos da Presidência da República e dos Ministérios"*;
- A **MPV 871/2019** com apelido de *"Combate a irregularidades em benefícios previdenciários"*
- A **PDL 233/2019** que *"regulamenta a Lei nº 10.826/2003, para dispor sobre a aquisição, o cadastro, o registro, a posse, o porte e a comercialização de armas de fogo e de munição e sobre o Sistema Nacional de Armas e o Sistema Nacional de Gerenciamento Militar de Armas."*
- A **PLS 224/2017** que *"altera a Lei nº 10.826/2003, para autorizar a aquisição de uma arma de fogo de uso permitido por residentes em áreas rurais."*

Ao total temos `r votos %>% count(id_votacao) %>% nrow()` votações em plenário.

## Aderência ao Governo
### Quem tem menos aderência?

Abaixo temos os 20 senadores que possuem menos aderência ao governo. Eles estão ordenados pelo número de vezes que não seguiram a orientação do governo e pela frequência dos senadores nas votações.

```{r}

theme_set(theme_classic())

# Plot
aderencia %>% 
  filter(id_tema == 99) %>% 
  arrange(desc(nao_seguiu), desc(freq)) %>% 
  head(20) %>% 
  ggplot(aes(x = reorder(nome_exibido, nao_seguiu), y = nao_seguiu)) + 
  geom_point(col="tomato3", size = 3) + 
  geom_segment(aes(x = nome_exibido, 
                   xend = nome_exibido, 
                   y = 0, 
                   yend = nao_seguiu), 
               size = 0.1) +
  coord_flip() +
  labs(title = "Senadores com menos aderência ao Governo",
       y = "Nº de votações em que não seguiu o Governo",
       x = "Senador") +
    theme_ipsum_rc()
```

### Mais detalhes sobre quem não adere
### Quem tem mais aderência?
### Aderência nos partidos
### Aderência nas Comissões
### Quantos deputados são aderentes ao Governo em Meio Ambiente e Agenda Nacional